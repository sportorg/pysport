{% extends "base.html" %}

{% block title %}Results{% endblock %}

{% block head %}
{{ super() }}
{% endblock %}

{% macro view_groups() -%}{% for group in groups %}<a href="#{{group.name}}">{{group.name}}</a> {% endfor %}{%- endmacro %}

{% block content %}
    <div class="text-center">
        <h2>Протокол командных результатов</h2>
        <h2>{{ race.sub_title }} <br>{{ race.date }} {{ race.location }}</h2>
    </div>
    <table class="sportorg-table">
    {% for group in groups %}
    {% if group.teams|length %}
        <tr style="background: white; border: 0">
        <td colspan="7" style="border: 0">
            <h2 id="{{group.name}}">{{group.name}}</h2>
            <div class="no-print">{{ view_groups() }}</div>
        </td>
        </tr>
        <tr>
            <td>№</td>
            <td>Коллектив/Субъект</td>
            <td>Очки</td>
            <td>Кол-во зачетных участников</td>
        </tr>
        {% set count = [1] %}
        {% for team in group.teams %}
            <tr>
                <td>{{ count|length}}</td>
                <td>{{ team.name }}</td>
                <td>{{ team.scores }}</td>
                <td>{{ team.member_qty }}</td>
            </tr>
            {% if count.append(1) %} {% endif %} {# increment count length by 1 #}
        {% endfor %}
    {% endif %}
    {% endfor %}
    </table>
    <div>
        <table class="empty-table">
            <tr>
                <td><b>Главный судья:</b></td>
                <td width="150px"></td>
                <td><b>{{ race.chief_referee }}</b></td>
            </tr>
            <tr>
                <td><b>Главный секретарь:</b></td>
                <td width="150px"></td>
                <td><b>{{ race.secretary }}</b></td>
            </tr>
        </table>
    </div>
{% endblock %}